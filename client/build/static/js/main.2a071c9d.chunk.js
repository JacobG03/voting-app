(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{10:function(e,t,n){e.exports={navbar:"Navbar_navbar__31-FB",content:"Navbar_content__qaagy",signin:"Navbar_signin__3U__V",action:"Navbar_action__678mY"}},11:function(e,t,n){e.exports={form:"LoginForm_form__2a8w7",switch:"LoginForm_switch__3MoTp",submit:"LoginForm_submit__2fOIw"}},16:function(e,t,n){e.exports={App:"App_App__16ZpL",content:"App_content__3La4L"}},22:function(e,t,n){},25:function(e,t,n){"use strict";n.r(t);var s=n(1),a=n.n(s),r=n(17),o=n.n(r),c=(n(22),n(3)),i=n(16),l=n.n(i),u=n(2),j=n.n(u),d=n(6),p="https://voting-app2.herokuapp.com/api";function b(e){return O.apply(this,arguments)}function O(){return(O=Object(d.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(p+t,{method:"GET",mode:"cors",credentials:"same-origin"}).then((function(e){return e.json().then((function(t){return{status:e.status,body:t}}))}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return m.apply(this,arguments)}function m(){return m=Object(d.a)(j.a.mark((function e(t){var n,s,a=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},e.next=3,fetch(p+t,{method:"POST",mode:"cors",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){return e.json().then((function(t){return{status:e.status,body:t}}))}));case 3:return s=e.sent,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}var f=n(5),_=n(7),v=n(8),x=n.n(v),g=n(14),y=n(0);function N(e){var t=Object(g.a)(),n=t.register,s=t.handleSubmit,a=t.unregister;return Object(y.jsxs)("form",{className:x.a.form,onSubmit:s((function(t){var n={topic:t.topic,options:[]};for(var s in t)"topic"!==s&&n.options.push(t[s]);h("/polls",n).then((function(t){200===t.status?(e.rerenderPolls((function(e){return!e})),e.displayPoll(!1)):console.log(t.body)}))})),children:[Object(y.jsxs)("div",{className:x.a.fields,children:[Object(y.jsx)("span",{children:"Topic:"}),Object(y.jsx)("input",Object(_.a)({placeholder:"Topic"},n("topic",{required:!0})))]}),Object(y.jsx)(P,{unregister:a,register:n}),Object(y.jsxs)("div",{className:x.a.finish,children:[Object(y.jsx)("span",{onClick:function(){return e.displayPoll((function(e){return!e}))},children:"Cancel"}),Object(y.jsx)("input",{type:"submit",className:x.a.submit,value:"Create Poll"})]})]})}function P(e){var t=Object(s.useState)([]),n=Object(c.a)(t,2),a=n[0],r=n[1];return Object(y.jsxs)("div",{className:x.a.options,children:[a.map((function(t){return Object(y.jsx)(S,{unregister:e.unregister,options:a,setOptions:r,option:t,register:e.register},t.id)})),Object(y.jsx)("button",{className:x.a.addBtn,onClick:function(){r((function(e){return[].concat(Object(f.a)(e),[{id:a.length}])}))},children:"Add Option"})]})}function S(e){return Object(y.jsxs)("div",{className:x.a.option,children:[Object(y.jsx)("input",Object(_.a)({placeholder:"Option ".concat(e.option.id)},e.register("option-".concat(e.option.id),{required:!0}))),Object(y.jsx)("button",{className:x.a.delBtn,onClick:function(){return function(){var t=e.options.filter((function(t){return t!==e.option}));e.unregister("option-".concat(e.option.id)),e.setOptions(t)}()},children:"-"})]})}var C=function(e){return Object(y.jsxs)("div",{className:x.a.main,children:[Object(y.jsxs)("div",{className:x.a.top,children:[Object(y.jsx)("img",{src:e.user.avatar,alt:"User"}),Object(y.jsx)("span",{children:e.user.username})]}),Object(y.jsx)(N,{rerenderPolls:e.rerenderPolls,displayPoll:e.displayPoll})]})},w=n(4),L=n.n(w);function F(e){var t=e.data,n=Object(s.useState)(t.votes),a=Object(c.a)(n,2),r=a[0],o=a[1];return Object(y.jsxs)("div",{className:L.a.poll,children:[Object(y.jsx)(B,{url:t.author_url}),Object(y.jsx)("span",{className:L.a.timestamp,children:t.timestamp}),Object(y.jsx)("div",{className:L.a.topic,children:Object(y.jsx)("span",{children:t.topic})}),Object(y.jsx)(k,{url:t.options_url,user:e.user,setVotesNum:o}),Object(y.jsx)("span",{className:L.a.poll_votes,children:r})]})}function k(e){var t=Object(s.useState)(null),n=Object(c.a)(t,2),a=n[0],r=n[1];Object(s.useEffect)((function(){b(e.url).then((function(e){return r(e.body)}))}),[e.url]);var o=Object(s.useCallback)((function(){b(e.url).then((function(t){r(null),r(t.body),e.setVotesNum((function(e){return e+1}))}))}),[e]);return a?Object(y.jsx)("div",{className:L.a.options,children:a.map((function(t){return Object(y.jsx)(q,{data:t,reqPoll:o,user:e.user},t.index)}))}):null}function q(e){var t=Object(s.useState)(null),n=Object(c.a)(t,2),a=n[0],r=n[1],o=Object(s.useState)(!1),i=Object(c.a)(o,2),l=i[0],u=i[1],j=e.data;return Object(s.useEffect)((function(){e.user&&b(j.votes_url).then((function(e){202===e.status?r(!0):200===e.status&&(r(e.body.votes),u(e.body.voted))}))}),[e.user,j.votes_url]),null===a?Object(y.jsx)("div",{className:L.a.option,children:Object(y.jsx)("span",{children:j.body})}):!0===a?Object(y.jsx)(A,{data:j,reqPoll:e.reqPoll}):Object(y.jsx)(U,{data:j,votes:a,voted:l})}function U(e){var t=Object(s.useState)(!1),n=Object(c.a)(t,2),a=n[0],r=n[1],o=e.data;return a?Object(y.jsxs)("div",{className:"".concat(L.a.option," ").concat(e.voted?L.a.voted:null),onClick:function(){return r(!a)},children:[Object(y.jsx)("div",{className:L.a.option_avatars,children:e.votes.length>0?e.votes.map((function(e){return Object(y.jsx)("img",{src:e.avatar,alt:"user"},e.username)})):Object(y.jsx)("span",{children:"No votes"})}),Object(y.jsx)("div",{className:L.a.option_votes,children:e.votes.length})]}):Object(y.jsxs)("div",{className:"".concat(L.a.option," ").concat(e.voted?L.a.voted:null),onClick:function(){return r(!a)},children:[Object(y.jsx)("div",{className:L.a.option_body,children:Object(y.jsx)("span",{children:o.body})}),Object(y.jsx)("div",{className:L.a.option_votes,children:e.votes.length})]})}function A(e){var t=e.data,n={anonymous:!1};return Object(y.jsx)("div",{className:"".concat(L.a.option," ").concat(L.a.vote),onClick:function(){return h(t.votes_url,n).then((function(e){return console.log(e.body.msg)})),void e.reqPoll()},children:Object(y.jsx)("span",{children:t.body})})}function B(e){var t=Object(s.useState)(null),n=Object(c.a)(t,2),a=n[0],r=n[1];return Object(s.useEffect)((function(){b(e.url).then((function(e){200===e.status&&r(e.body)}))}),[e.url]),a?Object(y.jsxs)("div",{className:L.a.author,children:[Object(y.jsx)("img",{src:a.avatar,alt:"Avatar"}),Object(y.jsx)("span",{children:a.username})]}):null}var T=function(e){var t=Object(s.useState)(null),n=Object(c.a)(t,2),a=n[0],r=n[1];return Object(s.useEffect)((function(){b("/polls").then((function(e){200===e.status&&r(e.body)}))}),[e.user,e.rpolls]),a?Object(y.jsx)("div",{className:L.a.polls,children:a.map((function(t){return Object(y.jsx)(F,{data:t,user:e.user},t.id)}))}):null},E=n(11),G=n.n(E);function I(e){var t=Object(g.a)(),n=t.register,s=t.handleSubmit,a=t.formState.errors;return Object(y.jsxs)("form",{className:G.a.form,onSubmit:s((function(t){h("/login",t).then((function(t){200===t.status&&b("/user").then((function(t){200===t.status&&(e.setUser(t.body),e.displayForm(!1))}))}))})),children:[Object(y.jsxs)("div",{children:[Object(y.jsx)("span",{children:"Login:"}),Object(y.jsx)("input",Object(_.a)({placeholder:"Login"},n("email",{required:!0}))),a.email&&Object(y.jsx)("span",{children:"This field is required"}),Object(y.jsx)("span",{children:"Password:"}),Object(y.jsx)("input",Object(_.a)({placeholder:"Password",type:"password"},n("password",{required:!0}))),a.password&&Object(y.jsx)("span",{children:"This field is required"})]}),Object(y.jsx)("input",{type:"submit",className:G.a.submit,value:"Sign In"}),Object(y.jsx)("span",{className:G.a.switch,onClick:function(){return e.changeForm((function(e){return!e}))},children:"Register"})]})}function R(e){var t=Object(g.a)(),n=t.register,s=t.handleSubmit,a=t.formState.errors;return Object(y.jsxs)("form",{className:G.a.form,onSubmit:s((function(t){h("/register",t).then((function(t){200===t.status?(console.log(t.body),e.changeForm((function(e){return!e}))):console.log(t.body)}))})),children:[Object(y.jsxs)("div",{children:[Object(y.jsx)("span",{children:"Username:"}),Object(y.jsx)("input",Object(_.a)({placeholder:"Username"},n("username",{required:!0,minLength:3,maxLength:64}))),Object(y.jsx)("span",{children:"Login:"}),Object(y.jsx)("input",Object(_.a)({placeholder:"Email or just a string"},n("email",{required:!0,minLength:1,maxLength:128}))),Object(y.jsx)("span",{children:"Password:"}),Object(y.jsx)("input",Object(_.a)({placeholder:"Password",type:"password"},n("password",{required:!0,minLength:3,maxLength:256}))),a.password&&Object(y.jsx)("span",{children:"This field is required"}),Object(y.jsx)("span",{children:"Repeat Password:"}),Object(y.jsx)("input",Object(_.a)({placeholder:"Repeat Password",type:"password"},n("password2",{required:!0,minLength:3,maxLength:256}))),Object(y.jsx)("span",{children:"Avatar:"}),Object(y.jsx)("input",Object(_.a)({placeholder:"URL: [PNG, JPG, GIF]"},n("avatar",{required:!0})))]}),Object(y.jsx)("input",{type:"submit",className:G.a.submit,value:"Sign Up"}),Object(y.jsx)("span",{className:G.a.switch,onClick:function(){return e.changeForm((function(e){return!e}))},children:"Login"})]})}var V=function(e){var t=Object(s.useState)(!1),n=Object(c.a)(t,2),a=n[0],r=n[1];return a?Object(y.jsx)(R,{changeForm:r}):Object(y.jsx)(I,{setUser:e.setUser,displayForm:e.displayForm,changeForm:r})},J=n(10),M=n.n(J);var Y=function(e){var t=Object(s.useCallback)((function(){b("/logout").then((function(t){200===t.status&&e.setUser(!1)}))}),[e]);return e.user?Object(y.jsx)("nav",{className:M.a.navbar,children:Object(y.jsxs)("div",{className:M.a.content,children:[Object(y.jsx)("span",{children:"<Voting App>"}),Object(y.jsxs)("div",{className:M.a.action,children:[e.user?Object(y.jsx)("button",{className:M.a.signin,onClick:function(){return e.displayPoll((function(e){return!e}))},children:"Create Poll"}):null,Object(y.jsx)("button",{className:M.a.signin,onClick:function(){return t()},children:"Sign out"})]})]})}):Object(y.jsx)("nav",{className:M.a.navbar,children:Object(y.jsxs)("div",{className:M.a.content,children:[Object(y.jsx)("span",{children:"<Voting App>"}),Object(y.jsx)("button",{className:M.a.signin,onClick:function(){return e.displayForm((function(e){return!e}))},children:"Sign in"})]})})};var H=function(){var e=Object(s.useState)(null),t=Object(c.a)(e,2),n=t[0],a=t[1],r=Object(s.useState)(!1),o=Object(c.a)(r,2),i=o[0],u=o[1],j=Object(s.useState)(!1),d=Object(c.a)(j,2),p=d[0],O=d[1],h=Object(s.useState)(!1),m=Object(c.a)(h,2),f=m[0],_=m[1];return Object(s.useEffect)((function(){b("/user").then((function(e){200===e.status?a(e.body):console.log("User is anonymous")}))}),[]),Object(y.jsxs)("div",{className:l.a.App,children:[Object(y.jsx)(Y,{user:n,setUser:a,displayForm:u,displayPoll:O}),Object(y.jsxs)("div",{className:l.a.content,children:[i?Object(y.jsx)(V,{setUser:a,displayForm:u}):null,n&&p?Object(y.jsx)(C,{user:n,rerenderPolls:_,displayPoll:O}):null,Object(y.jsx)(T,{user:n,rpolls:f})]})]})};o.a.render(Object(y.jsx)(a.a.StrictMode,{children:Object(y.jsx)(H,{})}),document.getElementById("root"))},4:function(e,t,n){e.exports={polls:"Polls_polls__1lS4d",poll:"Polls_poll__1aHj7",author:"Polls_author__2Y645",topic:"Polls_topic__S9NdO",timestamp:"Polls_timestamp__36Hh_",options:"Polls_options__mDcop",option:"Polls_option__1xedI",vote:"Polls_vote__XIMus",voted:"Polls_voted__3OnM-",poll_votes:"Polls_poll_votes__KqdhZ",option_body:"Polls_option_body__1bFLU",option_votes:"Polls_option_votes__3tslH",option_avatars:"Polls_option_avatars__3ncQa"}},8:function(e,t,n){e.exports={main:"CreatePoll_main__21y3u",top:"CreatePoll_top__BaGLz",form:"CreatePoll_form__2aajv",fields:"CreatePoll_fields__1_FGR",finish:"CreatePoll_finish__125dg",submit:"CreatePoll_submit__Ujss4",options:"CreatePoll_options__rYrbt",option:"CreatePoll_option__3RxLF",addBtn:"CreatePoll_addBtn__215TB",delBtn:"CreatePoll_delBtn__Pb3Ye"}}},[[25,1,2]]]);
//# sourceMappingURL=main.2a071c9d.chunk.js.map